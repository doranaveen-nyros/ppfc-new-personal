@page "/admin/adjustmentdays"
@using ppfc.DTO
@using Radzen
@using Radzen.Blazor
@attribute [Authorize]
@inject HttpClient Http
@inject NotificationService NotificationService

<RadzenNotification />

<PageTitle>Adjustment Days</PageTitle>

<h3 class="text-start mb-4">Adjustment Days</h3>

@if (IsLoading)
{
    <div class="d-flex flex-column align-items-center justify-content-center vh-100 text-muted">
        <div class="spinner-border text-primary mb-3" role="status"></div>
        <p>Loading adjustment days...</p>
    </div>
}
else
{
    <div class="row">
        <div class="col-md-6 mb-3">
            <div class="card">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <label class="col-form-label">Adjustment Days</label>
                        </div>
                        <div class="col">
                            <InputNumber @bind-Value="adjustmentDays"
                                         class="form-control form-control-sm" aria-label="Adjustment Days" />
                        </div>
                        <div class="col-auto">
                            <button type="button"
                                    class="btn btn-primary"
                                    @onclick="UpdateAdjustmentDays"
                                    disabled="@IsUpdating">
                                @if (IsUpdating)
                                {
                                    <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                                    <span>Updating...</span>
                                }
                                else
                                {
                                    <span>Update</span>
                                }
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-3">
            <div class="card">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-auto">
                            <label class="col-form-label">Old Data Limit</label>
                        </div>
                        <div class="col">
                            <InputSelect @bind-Value="oldDataLimit" class="form-select form-select-sm"
                                         aria-label="Old Data Limit">
                                @foreach (var d in dayOptions)
                                {
                                    <option value="@d">@d</option>
                                }
                            </InputSelect>
                        </div>
                        <div class="col-auto">
                            <button type="button"
                                    class="btn btn-primary"
                                    @onclick="UpdateOldDataLimit"
                                    disabled="@IsChanging">
                                @if (IsChanging)
                                {
                                    <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                                    <span>Changing...</span>
                                }
                                else
                                {
                                    <span>Change</span>
                                }
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}